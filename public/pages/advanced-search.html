<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Search - Driver Bonus Platform</title>
    <link href="../vendor/bootstrap/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="../vendor/fontawesome/css/all.min.css">
</head>
<body style="display: none;">
    <!-- Header injected by ui.js -->
    
    <div class="main-wrapper">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1 class="h4 mb-0">Advanced Search</h1>
        </div>
        
        <!-- Search Type Selector -->
        <div class="card-premium mb-4 p-4">
            <label class="form-label fw-bold">Search Type</label>
            <select id="searchType" class="form-select" onchange="updateSearchFields()">
                <option value="driver">Drivers</option>
                <option value="payment">Payments</option>
                <option value="audit">Audit Logs</option>
                <option value="import">Import Logs</option>
            </select>
        </div>
        
        <!-- Driver Search Fields -->
        <div id="driverFields" class="search-fields">
            <div class="card-premium mb-4 p-4">
                <h5 class="fw-bold mb-4">Driver Search Criteria</h5>
                <div class="row g-3">
                    <div class="col-md-4">
                        <label class="form-label small fw-bold text-muted">Driver Name</label>
                        <input type="text" id="driverName" class="form-control" placeholder="Enter name...">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label small fw-bold text-muted">Driver ID</label>
                        <input type="text" id="driverId" class="form-control" placeholder="Enter driver ID...">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label small fw-bold text-muted">Phone Number</label>
                        <input type="text" id="driverPhone" class="form-control" placeholder="Enter phone...">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label small fw-bold text-muted">TIN</label>
                        <input type="text" id="driverTin" class="form-control" placeholder="Enter TIN...">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label small fw-bold text-muted">Verification Status</label>
                        <select id="driverVerified" class="form-select">
                            <option value="">All</option>
                            <option value="true">Verified</option>
                            <option value="false">Unverified</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Payment Search Fields -->
        <div id="paymentFields" class="search-fields" style="display: none;">
            <div class="card-premium mb-4 p-4">
                <h5 class="fw-bold mb-4">Payment Search Criteria</h5>
                <div class="row g-3">
                    <div class="col-md-4">
                        <label class="form-label small fw-bold text-muted">Driver Name</label>
                        <input type="text" id="paymentDriverName" class="form-control" placeholder="Enter name...">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label small fw-bold text-muted">Driver ID</label>
                        <input type="text" id="paymentDriverId" class="form-control" placeholder="Enter driver ID...">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label small fw-bold text-muted">Status</label>
                        <select id="paymentStatus" class="form-select">
                            <option value="">All</option>
                            <option value="processing">Processing</option>
                            <option value="paid">Paid</option>
                            <option value="failed">Failed</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label small fw-bold text-muted">Payment Method</label>
                        <select id="paymentMethod" class="form-select">
                            <option value="">All</option>
                            <option value="bank_transfer">Telebirr</option>
                            <!-- <option value="mobile_money">Mobile Money</option>
                            <option value="cash">Cash</option> -->
                        </select>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label small fw-bold text-muted">Start Date</label>
                        <input type="date" id="paymentStartDate" class="form-control">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label small fw-bold text-muted">End Date</label>
                        <input type="date" id="paymentEndDate" class="form-control">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label small fw-bold text-muted">Min Amount</label>
                        <input type="number" id="paymentMinAmount" class="form-control" placeholder="0">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label small fw-bold text-muted">Max Amount</label>
                        <input type="number" id="paymentMaxAmount" class="form-control" placeholder="1000000">
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Audit Log Search Fields -->
        <div id="auditFields" class="search-fields" style="display: none;">
            <div class="card-premium mb-4 p-4">
                <h5 class="fw-bold mb-4">Audit Log Search Criteria</h5>
                <div class="row g-3">
                    <div class="col-md-4">
                        <label class="form-label small fw-bold text-muted">User</label>
                        <select id="auditUserId" class="form-select">
                            <option value="">All Users</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label small fw-bold text-muted">Action</label>
                        <input type="text" id="auditAction" class="form-control" placeholder="Enter action...">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label small fw-bold text-muted">Entity Type</label>
                        <select id="auditEntityType" class="form-select">
                            <option value="">All</option>
                            <option value="driver">Driver</option>
                            <option value="payment">Payment</option>
                            <option value="bonus">Bonus</option>
                            <option value="user">User</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label small fw-bold text-muted">Start Date</label>
                        <input type="date" id="auditStartDate" class="form-control">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label small fw-bold text-muted">End Date</label>
                        <input type="date" id="auditEndDate" class="form-control">
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Import Log Search Fields -->
        <div id="importFields" class="search-fields" style="display: none;">
            <div class="card-premium mb-4 p-4">
                <h5 class="fw-bold mb-4">Import Log Search Criteria</h5>
                <div class="row g-3">
                    <div class="col-md-4">
                        <label class="form-label small fw-bold text-muted">Imported By</label>
                        <select id="importUserId" class="form-select">
                            <option value="">All Users</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label small fw-bold text-muted">Start Date</label>
                        <input type="date" id="importStartDate" class="form-control">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label small fw-bold text-muted">End Date</label>
                        <input type="date" id="importEndDate" class="form-control">
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Action Buttons -->
        <div class="d-flex gap-3 mb-4">
            <button class="btn btn-brand" onclick="performSearch()">
                <i class="fas fa-search me-2"></i>Search
            </button>
            <button class="btn btn-outline-primary" onclick="saveCurrentSearch()">
                <i class="fas fa-save me-2"></i>Save Search
            </button>
            <button class="btn btn-outline-secondary" onclick="clearFilters()">
                <i class="fas fa-times me-2"></i>Clear
            </button>
        </div>
        
        <!-- Saved Searches -->
        <div class="card-premium mb-4 p-4">
            <h5 class="fw-bold mb-3">Saved Searches</h5>
            <div id="savedSearchesList"></div>
        </div>
        
        <!-- Search Results -->
        <div class="card-premium p-0 overflow-hidden">
            <div class="p-4 border-bottom bg-light">
                <div class="d-flex justify-content-between align-items-center">
                    <h5 class="fw-bold mb-0">Search Results</h5>
                    <span class="text-muted" id="resultsCount">0 results</span>
                </div>
            </div>
            <div id="searchResults">
                <div class="p-5 text-center text-muted">
                    <i class="fas fa-search fa-3x mb-3 opacity-25"></i>
                    <p>Enter search criteria and click Search to view results</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Save Search Modal -->
    <div class="modal fade" id="saveSearchModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Save Search</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <label class="form-label">Search Name</label>
                    <input type="text" id="saveSearchName" class="form-control" placeholder="Enter search name...">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-brand" onclick="confirmSaveSearch()">Save</button>
                </div>
            </div>
        </div>
    </div>
    
    <script src="../vendor/bootstrap/bootstrap.bundle.min.js"></script>
    <script src="/js/api.js"></script>
    <script src="/js/auth.js"></script>
    <script>
        // Check auth before showing content
        if (auth.isAuthenticated()) {
            document.body.style.display = 'block';
        }
    </script>
    <script src="/js/ui.js"></script>
    <script src="/js/advanced-search.js"></script>
</body>
</html>
